<!DOCTYPE html>
<html>
  <head>
    <title>Chatbot Support</title>
    <style>
      #chatbot {
        width: 300px;
        height: 500px;
        border: 1px solid #000;
        padding: 10px;
        overflow: auto;
      }
      #chatbot input {
        width: 100%;
        margin-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <h1>Chatbot Support</h1>
    <div id="chatbot">
      <p>Hello, welcome to our chatbot support! How can I assist you today?</p>
      <p>[user input]</p>
      <p>[chatbot response]</p>
    </div>
    <input type="text" id="userInput" placeholder="Type your message here..." />
    <script>
      const chatbot = document.getElementById('chatbot');
      const userInput = document.getElementById('userInput');

      userInput.addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
          const userMessage = userInput.value;
          chatbot.innerHTML += `<p>[user input]: ${userMessage}</p>`;
          // Here you can add the logic to send the user message to the chatbot and receive the response
          const chatbotResponse = 'This is a sample chatbot response.';
          chatbot.innerHTML += `<p>[chatbot response]: ${chatbotResponse}</p>`;
          userInput.value = '';
      
          // Include the CSRF token in the headers
          const xhr = new XMLHttpRequest();
          xhr.open('POST', '/chatbot/', true);
          xhr.setRequestHeader('Content-Type', 'application/json');
          xhr.setRequestHeader('X-CSRFToken', {{ csrf_token }});
          xhr.onload = function() {
            if (xhr.status === 200) {
              const chatbotResponse = JSON.parse(xhr.responseText).message;
              chatbot.innerHTML += `<p>[chatbot response]: ${chatbotResponse}</p>`;
            } else {
              console.error('Request failed. Status code:', xhr.status);
            }
          };
          xhr.send(JSON.stringify({ message: userMessage }));
        }
      });
    </script>
  </body>
</html>